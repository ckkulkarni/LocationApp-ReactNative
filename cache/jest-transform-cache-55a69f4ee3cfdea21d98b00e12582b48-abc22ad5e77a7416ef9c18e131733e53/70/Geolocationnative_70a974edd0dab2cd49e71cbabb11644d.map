{"version":3,"names":["_reactNative","require","RNFusedLocation","NativeModules","LocationEventEmitter","NativeEventEmitter","noop","subscriptions","updatesEnabled","Geolocation","setRNConfiguration","config","requestAuthorization","_requestAuthorization","_asyncToGenerator2","default","authorizationLevel","Platform","OS","Promise","reject","console","error","_x","apply","arguments","getCurrentPosition","success","length","undefined","options","watchPosition","startObserving","watchID","push","addListener","clearWatch","sub","remove","sub1","noWatchers","ii","stopObserving","warn","_default","exports"],"sources":["Geolocation.native.js"],"sourcesContent":["import { NativeEventEmitter, NativeModules, Platform } from 'react-native';\n\nconst { RNFusedLocation } = NativeModules;\nconst LocationEventEmitter = new NativeEventEmitter(RNFusedLocation);\n\nconst noop = () => {};\nlet subscriptions = [];\nlet updatesEnabled = false;\n\nconst Geolocation = {\n  setRNConfiguration: (config) => {}, // eslint-disable-line no-unused-vars\n\n  requestAuthorization: async (authorizationLevel) => {\n    if (Platform.OS !== 'ios') {\n      return Promise.reject('requestAuthorization is only for iOS');\n    }\n\n    if (!authorizationLevel) {\n      // eslint-disable-next-line no-console\n      console.error('authorizationLevel must be provided');\n    }\n\n    return RNFusedLocation.requestAuthorization(authorizationLevel);\n  },\n\n  getCurrentPosition: (success, error = noop, options = {}) => {\n    if (!success) {\n      // eslint-disable-next-line no-console\n      console.error('Must provide a success callback');\n    }\n\n    // Right now, we're assuming user already granted location permission.\n    RNFusedLocation.getCurrentPosition(options, success, error);\n  },\n\n  watchPosition: (success, error = null, options = {}) => {\n    if (!success) {\n      // eslint-disable-next-line no-console\n      console.error('Must provide a success callback');\n    }\n\n    if (!updatesEnabled) {\n      RNFusedLocation.startObserving(options);\n      updatesEnabled = true;\n    }\n\n    const watchID = subscriptions.length;\n\n    subscriptions.push([\n      LocationEventEmitter.addListener('geolocationDidChange', success),\n      error ? LocationEventEmitter.addListener('geolocationError', error) : null\n    ]);\n\n    return watchID;\n  },\n\n  clearWatch: (watchID) => {\n    const sub = subscriptions[watchID];\n\n    if (!sub) {\n      // Silently exit when the watchID is invalid or already cleared\n      // This is consistent with timers\n      return;\n    }\n\n    sub[0].remove();\n\n    const sub1 = sub[1];\n\n    if (sub1) {\n      sub1.remove();\n    }\n\n    subscriptions[watchID] = undefined;\n\n    let noWatchers = true;\n\n    for (let ii = 0; ii < subscriptions.length; ii += 1) {\n      if (subscriptions[ii]) {\n        noWatchers = false; // still valid subscriptions\n      }\n    }\n\n    if (noWatchers) {\n      Geolocation.stopObserving();\n    }\n  },\n\n  stopObserving: () => {\n    if (updatesEnabled) {\n      RNFusedLocation.stopObserving();\n      updatesEnabled = false;\n\n      for (let ii = 0; ii < subscriptions.length; ii += 1) {\n        const sub = subscriptions[ii];\n        if (sub) {\n          // eslint-disable-next-line no-console\n          console.warn('Called stopObserving with existing subscriptions.');\n          sub[0].remove();\n\n          const sub1 = sub[1];\n\n          if (sub1) {\n            sub1.remove();\n          }\n        }\n      }\n\n      subscriptions = [];\n    }\n  }\n};\n\nexport default Geolocation;\n"],"mappings":"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"}